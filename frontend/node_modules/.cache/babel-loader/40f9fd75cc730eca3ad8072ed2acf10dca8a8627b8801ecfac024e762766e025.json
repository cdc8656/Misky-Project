{"ast":null,"code":"import axios from \"axios\"; //alows for HTTP requests to be made to FastAPI backend.\n\nexport const API_BASE_URL = \"http://localhost:3000\"; //local hosting\n//\"https://misky-project.onrender.com\"; //base URL of FastAPI backend\n\nexport const getAccessToken = async supabase => {\n  //supabase.auth.getSession() to fetch the current user's session, which includes the access token if logged in\n  const {\n    data: {\n      session\n    },\n    error\n  } = await supabase.auth.getSession();\n  if (error) {\n    console.error(\"Error fetching session:\", error.message);\n    return null;\n  }\n  return (session === null || session === void 0 ? void 0 : session.access_token) || null; // returns the access token, which is needed to authenticate API requests to your backend\n};\n\n// Fetch all available food items (for customers)\nexport const fetchItems = async supabase => {\n  //Gets the access token. If the user is not logged in, throws an error\n  const token = await getAccessToken(supabase);\n  if (!token) throw new Error(\"Not authenticated\");\n  try {\n    const res = await axios.get(`${API_BASE_URL}/items`, {\n      // Make a GET request to the /items route in FastAPI backend\n      headers: {\n        Authorization: `Bearer ${token}`\n      } // with an Authorization header\n    });\n    return res.data; //Returns the data from the response (the food items)\n  }\n  //If the request fails, logs the error and throws a readable error \n  catch (err) {\n    var _err$response, _err$response$data;\n    console.error(\"Error fetching items:\", err);\n    throw new Error(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) || \"Failed to fetch items\");\n  }\n};\n\n// Create a reservation\nexport const createReservation = async (supabase, payload) => {\n  //Gets the access token. If the user is not logged in, throws an error\n  const token = await getAccessToken(supabase);\n  if (!token) throw new Error(\"Not authenticated\");\n  try {\n    const res = await axios.post(`${API_BASE_URL}/reservations`, payload, {\n      //Sends a POST request to /reservations with the reservation data in the body\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return res.data; //Returns the data from the response\n  }\n  //Logs and throws an error message if the reservation creation fails\n  catch (err) {\n    var _err$response2, _err$response2$data;\n    console.error(\"Error creating reservation:\", err);\n    throw new Error(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.detail) || \"Failed to create reservation\");\n  }\n};\n\n// Get user reservations\nexport const fetchReservations = async supabase => {\n  //Gets the access token. If the user is not logged in, throws an error\n  const token = await getAccessToken(supabase);\n  if (!token) throw new Error(\"Not authenticated\");\n  try {\n    const res = await axios.get(`${API_BASE_URL}/reservations`, {\n      //Make a GET request /reservations to retrieve reservations for the authenticated user.\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return res.data; //Returns the data from the response\n  }\n  // Logs and throws an error message if the reservation creation fails\n  catch (err) {\n    var _err$response3, _err$response3$data;\n    console.error(\"Error fetching reservations:\", err);\n    throw new Error(((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.detail) || \"Failed to fetch reservations\");\n  }\n};","map":{"version":3,"names":["axios","API_BASE_URL","getAccessToken","supabase","data","session","error","auth","getSession","console","message","access_token","fetchItems","token","Error","res","get","headers","Authorization","err","_err$response","_err$response$data","response","detail","createReservation","payload","post","_err$response2","_err$response2$data","fetchReservations","_err$response3","_err$response3$data"],"sources":["C:/Users/chrix/OneDrive/Documents/Python/Misky FastApi/frontend/src/api.js"],"sourcesContent":["import axios from \"axios\"; //alows for HTTP requests to be made to FastAPI backend.\r\n\r\nexport const API_BASE_URL = \"http://localhost:3000\" //local hosting\r\n//\"https://misky-project.onrender.com\"; //base URL of FastAPI backend\r\n\r\nexport const getAccessToken = async (supabase) => { //supabase.auth.getSession() to fetch the current user's session, which includes the access token if logged in\r\n  const {\r\n    data: { session },\r\n    error,\r\n  } = await supabase.auth.getSession();\r\n\r\n  if (error) {\r\n    console.error(\"Error fetching session:\", error.message);\r\n    return null;\r\n  }\r\n\r\n  return session?.access_token || null; // returns the access token, which is needed to authenticate API requests to your backend\r\n};\r\n\r\n// Fetch all available food items (for customers)\r\nexport const fetchItems = async (supabase) => {\r\n  //Gets the access token. If the user is not logged in, throws an error\r\n  const token = await getAccessToken(supabase);\r\n  if (!token) throw new Error(\"Not authenticated\");\r\n\r\n  try {\r\n    const res = await axios.get(`${API_BASE_URL}/items`, { // Make a GET request to the /items route in FastAPI backend\r\n      headers: { Authorization: `Bearer ${token}` }, // with an Authorization header\r\n    });\r\n    return res.data; //Returns the data from the response (the food items)\r\n  }\r\n  //If the request fails, logs the error and throws a readable error \r\n  catch (err) {\r\n    console.error(\"Error fetching items:\", err);\r\n    throw new Error(err.response?.data?.detail || \"Failed to fetch items\");\r\n  }\r\n};\r\n\r\n// Create a reservation\r\nexport const createReservation = async (supabase, payload) => {\r\n  //Gets the access token. If the user is not logged in, throws an error\r\n  const token = await getAccessToken(supabase);\r\n  if (!token) throw new Error(\"Not authenticated\");\r\n\r\n  try {\r\n    const res = await axios.post(`${API_BASE_URL}/reservations`, payload, { //Sends a POST request to /reservations with the reservation data in the body\r\n      headers: { Authorization: `Bearer ${token}` },\r\n    });\r\n    return res.data; //Returns the data from the response\r\n  } \r\n  //Logs and throws an error message if the reservation creation fails\r\n  catch (err) {\r\n    console.error(\"Error creating reservation:\", err);\r\n    throw new Error(err.response?.data?.detail || \"Failed to create reservation\");\r\n  }\r\n};\r\n\r\n// Get user reservations\r\nexport const fetchReservations = async (supabase) => {\r\n  //Gets the access token. If the user is not logged in, throws an error\r\n  const token = await getAccessToken(supabase);\r\n  if (!token) throw new Error(\"Not authenticated\");\r\n\r\n  try {\r\n    const res = await axios.get(`${API_BASE_URL}/reservations`, { //Make a GET request /reservations to retrieve reservations for the authenticated user.\r\n      headers: { Authorization: `Bearer ${token}` },\r\n    });\r\n    return res.data; //Returns the data from the response\r\n  } \r\n  // Logs and throws an error message if the reservation creation fails\r\n  catch (err) {\r\n    console.error(\"Error fetching reservations:\", err);\r\n    throw new Error(err.response?.data?.detail || \"Failed to fetch reservations\");\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}